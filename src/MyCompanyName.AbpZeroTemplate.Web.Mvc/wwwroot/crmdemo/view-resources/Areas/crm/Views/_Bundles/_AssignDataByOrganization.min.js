var OrganizationTree=function(e){return function(){function a(){var a=!1;e("#OrganizationTreeFilter").keyup(function(){a&&clearTimeout(a),a=setTimeout(function(){var a=e("#OrganizationTreeFilter").val();t.jstree(!0).search(a)},250)})}function n(e){t.jstree("select_node",e,!0);var a=t.jstree("get_parent",e);a&&n(a)}var t;return{init:function(i){(t=i).jstree({types:{default:{icon:"fa fa-folder m--font-warning"},file:{icon:"fa fa-file  m--font-warning"}},checkbox:{keep_selected_style:!1,three_state:!1,cascade:""},search:{show_only_matches:!0},plugins:["types","search","checkbox"]}),t.on("changed.jstree",function(a,i){if(i.node){var r;i.node.state.selected?(n(t.jstree("get_parent",i.node)),r=e.makeArray(t.jstree("get_children_dom",i.node)),t.jstree("select_node",r)):(r=e.makeArray(t.jstree("get_children_dom",i.node)),t.jstree("deselect_node",r))}}),a()},getSelectedOrganizations:function(){for(var e=[],a=t.jstree("get_selected",!0),n=0;n<a.length;n++)e.push(a[n].id);return e}}}}(jQuery);!function(e){app.modals.AssignDataByOrganizationModal=function(){var a,n=abp.services.app.customerDatas,t=null;(a=new OrganizationTree).init(e(".organization-tree")),this.init=function(a){_modalManager=a;var n=_modalManager.getModal();n.find(".numeric").number(!0,0),n.find(".date-picker").datetimepicker({locale:abp.localization.currentLanguage.name,format:"L"}),n.find(".date-picker").each(function(){"01/01/0001"==e(this).val()&&e(this).data("DateTimePicker").date(new Date)}),(t=_modalManager.getModal().find("form[name=AssignDataByOrganizationForm]")).validate()},e("#AssignDataButton").click(function(e){if(e.preventDefault(),t.valid()){var i=t.serializeFormToObject();i.organizationIds=a.getSelectedOrganizations(),_modalManager.setBusy(!0),n.assignDataByOrganization(i).done(function(){abp.notify.info(app.localize("AssignSuccessfully"))}).always(function(){_modalManager.setBusy(!1)})}})}}(jQuery);